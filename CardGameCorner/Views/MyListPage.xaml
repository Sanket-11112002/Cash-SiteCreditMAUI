<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CardGameCorner.Views.MyListPage"
             xmlns:vm="clr-namespace:CardGameCorner.ViewModels"
             x:Name="MyListPageRoot">

    <ContentPage.BindingContext>
        <vm:MyListViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout>
            <Label Text="No items available."
           HorizontalOptions="Center"
           VerticalOptions="Center"
           IsVisible="{Binding listvisibility}" />

            <ListView ItemsSource="{Binding CardItems}" HasUnevenRows="True">

                <!-- EmptyView for empty ListView -->

                <ListView.ItemTemplate IsVisible="{Binding listvisibilitycards}">
                    <DataTemplate>
                        <ViewCell>
                            <Grid Padding="16" ColumnDefinitions="*, *, *, *,*" 
                                  RowDefinitions="Auto, Auto" 
                                  BackgroundColor="#22313F" ColumnSpacing="10">

                                <!-- Image (Column 0) -->
                                <Image Source="{Binding Image}" 
                                       HeightRequest="100" 
                                       WidthRequest="70" 
                                       Aspect="AspectFit" 
                                       Grid.Column="0" 
                                       Grid.RowSpan="2" />

                                <!-- Name and Model (Column 1) -->
                                <StackLayout Grid.Column="1" Grid.Row="0" Grid.RowSpan="1" Orientation="Vertical" Spacing="5">
                                    <Label Text="{Binding Model}" 
                                           FontSize="14" 
                                           FontAttributes="Bold" 
                                           TextColor="White" />
                                    <Label Text="{Binding Category}" 
                                           FontSize="14" 
                                           TextColor="#cccccc" />
                                </StackLayout>

                                <!-- Combined Language, Condition, Edition, and Rarity (Column 2) -->
                                <StackLayout Grid.Column="2" Grid.RowSpan="2" Orientation="Vertical" HorizontalOptions="Center" Spacing="5">
                                    <!-- Language and Condition Section -->
                                    <StackLayout Orientation="Horizontal"  HorizontalOptions="Center">
                                        <Image x:Name="Lngflag" 
                                               HeightRequest="20" 
                                               WidthRequest="40"
                                               Margin="10,0,0,0" 
                                               Source="{Binding Languageflag}"/>

                                        <!-- Condition -->
                                        <Frame BackgroundColor="LightGreen" Padding="0,0" CornerRadius="3" HasShadow="False">
                                            <Label Text="{Binding Condition}" 
                                                   TextColor="White" 
                                                   FontSize="10" 
                                                   HeightRequest="10" 
                                                   WidthRequest="30"
                                                   HorizontalTextAlignment="Center" />
                                        </Frame>
                                    </StackLayout>

                                    <!-- Edition and Rarity Section -->
                                    <StackLayout Orientation="Vertical" Spacing="5" HorizontalOptions="Center">
                                        <!-- Edition -->
                                        <Label Text="{Binding Edition}"
                                               FontSize="12" 
                                               TextColor="#5DADE2" 
                                               HorizontalTextAlignment="Center" />
                                        <!-- Rarity -->
                                        <Frame CornerRadius="2" HasShadow="False"  Padding="2,2"  BackgroundColor="DodgerBlue">
                                            <Label Text="{Binding Rarity}"
                                             TextColor="White" 
                                             FontSize="10" 
                                             HorizontalTextAlignment="Center" />
                                        </Frame>
                                    </StackLayout>
                                </StackLayout>

                                <!-- Cash and Credit (Column 4) -->
                                <StackLayout Grid.Column="3" Grid.Row="0" Orientation="Vertical" Spacing="5">
                                    <Label Text="{Binding BindingContext.CashTitle, Source={x:Reference MyListPageRoot}}" 
                                               FontSize="12" 
                                               TextColor="LightGreen" 
                                               FontAttributes="Bold" 
                                               HorizontalTextAlignment="Center" />
                                    <Label Text="{Binding Buylist ,  StringFormat='{0:F2} EUR'}"
                                                   FontSize="12" 
                                                   TextColor="White" 
                                                   HorizontalTextAlignment="Center" />

                                    <Label Text="{Binding BindingContext.CreditTitle, Source={x:Reference MyListPageRoot}}"
                                               FontSize="12"
                                               TextColor="LightGreen"
                                               FontAttributes="Bold"
                                               HorizontalTextAlignment="Center" />
                                    <Label Text="{Binding Sitecredit,  StringFormat='{0:F2} EUR'}"
                                                   FontSize="12" 
                                                   TextColor="White" 
                                                   HorizontalTextAlignment="Center" />
                                </StackLayout>

                                <!-- Quantity and Actions (Column 4) -->
                                <StackLayout Grid.Column="4" Grid.Row="0" Orientation="Vertical" HorizontalOptions="End" Spacing="5">
                                    <Label Text="{Binding BindingContext.QuantityTitle, Source={x:Reference MyListPageRoot}}"
                                           FontSize="12"
                                           TextColor="LightGreen"
                                           FontAttributes="Bold"
                                           HorizontalTextAlignment="Center" />
                                    <Label Text="{Binding Quantity}" 
                                           FontSize="12" 
                                           TextColor="White" 
                                           HorizontalTextAlignment="Center" />

                                    <Button Text="{Binding BindingContext.PEdit, Source={x:Reference MyListPageRoot}}" 
                                            FontSize="12" 
                                            Command="{Binding BindingContext.NavigateToCardDetailCommand, Source={x:Reference MyListPageRoot}}" 
                                            CommandParameter="{Binding .}"
                                            TextColor="White" 
                                            BackgroundColor="#6C3483" 
                                            CornerRadius="5"
                                            Padding="5,2" />
                                    <Button Text="{Binding BindingContext.PDelete, Source={x:Reference MyListPageRoot}}" 
                                      FontSize="12" 
                                      Command="{Binding BindingContext.DeleteCardCommand, Source={x:Reference MyListPageRoot}}" 
                                      CommandParameter="{Binding .}"
                                      TextColor="White" 
                                      BackgroundColor="Red" 
                                      CornerRadius="5" 
                                      Padding="5,2" />
                                </StackLayout>
                            </Grid>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Button Text="{Binding PlaceOrder}"
                    TextColor="White"
                    BackgroundColor="#6C3483"
                    FontSize="18"       
                    HeightRequest="60"
                    WidthRequest="200"
                    CornerRadius="10"
                    Padding="20,10"
                    Margin="20,30,20,20"
                    HorizontalOptions="Center"
                    VerticalOptions="Center"
                    Clicked="PlaceOrder_Clicked" />
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
